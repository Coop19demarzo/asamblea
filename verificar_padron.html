<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Verificar Socio - Cooperativa</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
body {
    font-family: Arial, sans-serif;
    background-color: #f9f9f9;
    padding: 20px;
    text-align: center;
}
h1 {
    color: #2E7D32;
}
input, select, button {
    padding: 10px;
    margin: 10px 5px;
    font-size: 1em;
}
#resultado {
    margin-top: 20px;
    font-size: 1.2em;
    padding: 15px;
    border-radius: 5px;
}
.result-ok { background-color: #dff0d8; color: #3c763d; }
.result-warn { background-color: #f2dede; color: #a94442; }
</style>
</head>
<body>
<h1>Verificar Estado de Socio</h1>

<p>Seleccione el tipo de búsqueda e ingrese el dato correspondiente:</p>
<select id="tipoBusqueda">
    <option value="ci">C.I.</option>
    <option value="socio">Número de Socio</option>
    <option value="nombre">Nombre</option>
</select>
<input type="text" id="busqueda" placeholder="Ingrese dato">
<button onclick="buscarSocio()">Buscar</button>

<div id="resultado"></div>

<script>
let padron = [];

// Aquí reemplaza con tu link RAW de GitHub
const excelUrl = "https://raw.githubusercontent.com/TU_USUARIO/TU_REPO/main/padron.xlsx";

// Cargar Excel al iniciar
window.onload = async function() {
    try {
        const res = await fetch(excelUrl);
        const data = await res.arrayBuffer();
        const workbook = XLSX.read(data, { type: "array" });
        const sheetName = workbook.SheetNames[0];
        padron = XLSX.utils.sheet_to_json(workbook.Sheets[sheetName], { range: 2 });
        console.log("Padron cargado:", padron.length, "socios");
    } catch (err) {
        alert("Error al cargar Excel: " + err);
        console.error(err);
    }
}

function buscarSocio() {
    const q = document.getElementById("busqueda").value.trim().toLowerCase();
    const tipo = document.getElementById("tipoBusqueda").value;
    const resultado = document.getElementById("resultado");

    if (!q) {
        resultado.innerHTML = "Ingrese un dato para buscar.";
        resultado.className = "";
        return;
    }

    let s;
    if (tipo === "ci") {
        s = padron.find(x => (x["C.I.Nro"] + "").toLowerCase() === q);
    } else if (tipo === "socio") {
        s = padron.find(x => (x["SOCIO"] + "").toLowerCase() === q);
    } else if (tipo === "nombre") {
        s = padron.find(x => (x["APELLIDO, NOMBRE"] + "").toLowerCase().includes(q));
    }

    if (!s) {
        resultado.innerHTML = "❌ Socio no encontrado.";
        resultado.className = "result-warn";
        return;
    }

    let estado = s["HABILITADO"].toLowerCase().includes("voz y voto") 
                 ? "✔ Habilitado: VOZ Y VOTO" 
                 : "⚠ Solo VOZ";

    resultado.innerHTML = `
        <b>Nombre:</b> ${s["APELLIDO, NOMBRE"]} <br>
        <b>Número de Socio:</b> ${s["SOCIO"]} <br>
        <b>C.I.:</b> ${s["C.I.Nro"]} <br>
        <b>Estado:</b> ${estado}
    `;
    resultado.className = estado.includes("VOZ Y VOTO") ? "result-ok" : "result-warn";
}
</script>
</body>
</html>



